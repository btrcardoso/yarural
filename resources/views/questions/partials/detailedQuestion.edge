{{--  Title  --}}
<div>
    <!-- Title -->
    <p class="text-4xl font-bold break-words">{{ question.question }}</p>
</div>

{{--  Date, Delete Button  --}}
@!component('components/dateAndDeleteButton',{
    user: user,
    routeNameButtonDelete: 'question.destroy',
    idObjectDeleted: question.id,
    date: date,
    deleteMessage: 'Tem certeza que deseja excluir a sua pergunta?',
    modalName: 'question'
})

{{-- Image, Username--}}
@!component('components/imageAndUsername', {
    username: user.username
})

{{-- Category, Likes --}}
<div class="flex justify-between">

    <div>
        <!-- Category -->
        <label class="label">
            <span class="label-text"> 
                <p class="font-sans font-bold text-base">
                    Categoria:
                    <a class="hover:underline" href="{{ route('category.show', {id: category.id}) }}">{{ category ? category.name : 'NÃ£o especificado' }}</a> 
                </p>    
            </span>
        </label>
    </div>

    <div>
        <!-- Likes -->
        @!component('components/likes',{
            likes: question.likes,
            likeRoute: route('question_like.like', {questionId: question.id}),
            dislikeRoute: route('question_like.dislike', {questionId: question.id}),
            type: 'question',
            id: question.id,
            likeValue: question.likeValue
        })
    </div>

</div>

{{-- Description --}}
@if(question.description)

    <div class="p-4">
        <!-- Description -->
        <p class="break-words">
            {{ question.description}}
        </p>
    </div>

@endif

<script>

    function getLikeBehaviors(type, action){

        let route = "/like_pergunta"
        let swLike = "3.5"
        let swDislike = "1.5"
        let newActionLike = 0
        let newActionDislike = -1

        if(type == "question"){
            switch(action){
                case 1:
                    route = "/like_pergunta"
                    swLike = "3.5"
                    swDislike = "1.5"
                    newActionLike = 0
                    newActionDislike = -1
                    break
                case -1:
                    route = "/dislike_pergunta"
                    swLike = "1.5"
                    swDislike = "3.5"
                    newActionLike = 1
                    newActionDislike = 0
                    break
                case 0: 
                    route = "/deletar_like_pergunta"
                    swLike = "1.5"
                    swDislike = "1.5"
                    newActionLike = 1
                    newActionDislike = -1
                    break
                default:
                    route="/"
                    swLike = "1.5"
                    swDislike = "1.5"
                    newActionLike = 1
                    newActionDislike = -1
                    break
            }
        } else {
            route="/"
        }

        return {
            route, swLike, swDislike, newActionLike, newActionDislike
        }
        
    }

    function like(type, id, action){

        let likeBehaviors = getLikeBehaviors(type, action)

        fetch(likeBehaviors.route+"/"+id)
            .then(response => response.json())
            .then(json => {
                document.getElementById(`like-${type}-${id}`).setAttribute("onclick", `like('${type}', ${id}, ${likeBehaviors.newActionLike})`)
                document.getElementById(`dislike-${type}-${id}`).setAttribute("onclick", `like('${type}', ${id}, ${likeBehaviors.newActionDislike})`)
                document.getElementById(`svg-like-${type}-${id}`).setAttribute("stroke-width",likeBehaviors.swLike)
                document.getElementById(`svg-dislike-${type}-${id}`).setAttribute("stroke-width",likeBehaviors.swDislike)
                document.getElementById(`countlikes-${type}-${id}`).innerHTML = json.countLikes
            })

    }

</script>